<cs-page-header
  title-name="{{$ctrl.title}}"
  back="true"
  back-url="$ctrl.huronFeaturesUrl"
  back-aria-label="{{::'common.back' | translate}}">
</cs-page-header>
<div class="call-feature-edit">
  <div class="loading-container" ng-if="$ctrl.isLoading">
    <i class='icon icon-spinner'></i>
  </div>
  <form novalidate class="cs-form content-container" name="$ctrl.form" role="form" ng-if="!$ctrl.isLoading">
    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="callPark.settingsTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="callPark.nameLabel"></h5>
          <p class="sub-section__description" translate="callPark.nameDesc"></p>
          <uc-call-feature-name
            placeholder-key="callPark.namePlaceholder"
            name-hint-key="callPark.nameHint"
            name="$ctrl.callPark.name"
            is-required="true"
            is-new="false"
            on-change-fn="$ctrl.setCallParkName(name)"
            on-key-press-fn="$ctrl.enterNextPage(keyCode)"
            ng-class="$ctrl.animation">
          </uc-call-feature-name>
        </div>
        <div class="sub-section row collapse" ng-if="$ctrl.hasLocation">
          <h5 class="sub-section__title" translate="callPark.locationLabel"></h5>
          <uc-call-feature-location
            call-feature-type="huronFeatureDetails.cp"
            is-required="true"
            is-new="false"
            location="$ctrl.callPark.location"
            on-change-fn="$ctrl.setCallParkLocation(location)"
            class="columns medium-6">
          </uc-call-feature-location>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__title" translate="callPark.numberLabel"></h5>
          <p class="sub-section__description" translate="callPark.numberDesc"></p>
          <uc-call-park-number
            range="$ctrl.range"
            extension-length="$ctrl.extensionLength"
            on-change-fn="$ctrl.setCallParkRange(range)"
            location="$ctrl.callPark.location">
          </uc-call-park-number>
        </div>
      </div>
    </div>

    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="callPark.reversionTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="callPark.reversionRuleLabel"></h5>
          <p class="sub-section__description" translate="callPark.reversionRuleDesc"></p>
          <uc-call-park-fallback-destination
            fallback-destination="$ctrl.callPark.fallbackDestination"
            on-change-fn="$ctrl.setCallParkFallbackDestination(fallbackDestination)"
            location="$ctrl.callPark.location">
          </uc-call-park-fallback-destination>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__title" translate="callPark.reversionTimerLabel"></h5>
          <p class="sub-section__description" translate="callPark.reversionTimerDesc"></p>
          <uc-call-park-reversion-timer
            fallback-timer="$ctrl.callPark.fallbackTimer"
            on-change-fn="$ctrl.setCallParkFallbackTimer(seconds)">
          </uc-call-park-reversion-timer>
        </div>
      </div>
    </div>

    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="callPark.membersTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="callPark.memberLabel"></h5>
          <p class="sub-section__description" translate="callPark.memberDesc"></p>
          <uc-call-feature-members
            members="$ctrl.callPark.members"
            member-item-type="member"
            filter-by="$ctrl.memberProperties"
            card-type="simple"
            show-external-numbers="false"
            drag-and-drop="false"
            on-change-fn="$ctrl.setCallParkMembers(members)"
            location="$ctrl.callPark.location">
          </uc-call-feature-members>
        </div>
      </div>
    </div>

    <div class="save-section" ng-if="$ctrl.form.$dirty">
      <p translate="common.saveLabel"></p>
      <button
        cs-btn
        ng-click="$ctrl.onCancel()">
        <span translate="common.cancel"></span>
      </button>
      <button
        cs-btn
        class="btn btn--primary"
        loading="$ctrl.saveInProcess"
        ng-click="$ctrl.save()"
        ng-disabled="$ctrl.form.$invalid || $ctrl.saveInProcess">
        <span translate="common.save"></span>
      </button>
    </div>
  </form>
</div>
