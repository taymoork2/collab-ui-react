<cs-page-header
  title-name="{{$ctrl.title}}"
  back="true"
  back-url="$ctrl.huronFeaturesUrl">
</cs-page-header>
<div class="loading-container" ng-if="$ctrl.isLoading">
  <i class='icon icon-spinner'></i>
</div>
<form novalidate class="cs-form pi-edit" name="$ctrl.form" role="form" ng-if="!$ctrl.isLoading">
  <div class="cs-form__section cs-form__section-first">
    <div class="section__info">
      <h4 class="section__title" translate="callPickup.nameTitle"></h4>
    </div>
    <div class="section__content">
      <div class="sub-section">
        <h5 class="sub-section__title" translate="callPickup.nameLabel"></h5>
        <p class="sub-section__description" translate="callPickup.nameHint"></p>
        <uc-call-pickup-name
          on-update="$ctrl.setCallPickupName(name, isValid)"
          call-pickup-name="$ctrl.callPickup.name"
          is-new="false">
        </uc-call-pickup-name>
      </div>
    </div>
  </div>
  <div class="cs-form__section">
    <div class="section__info">
      <h4 class="section__title" translate="callPickup.notificationTitle"></h4>
    </div>
    <div class="section__content">
      <div class="sub-section">
        <h5 class="sub-section__title" translate="callPickup.notificationTimer"></h5>
        <p class="sub-section__description" translate="callPickup.timerHint"></p>
        <uc-call-pickup-notification-timer
          notification-timer="$ctrl.callPickup.notificationTimer"
          on-change-fn="$ctrl.setCallPickupNotificationTimer(notificationTimer)">
        </uc-call-pickup-notification-timer>
      </div>
      <div class="sub-section">
        <h5 class="sub-section__title" translate="callPickup.pickupNotification"></h5>
        <p class="sub-section__description" translate="callPickup.pickupHint"></p>
        <uc-call-pickup-notifications
          on-change-fn="$ctrl.setNotifications(playSound, displayCalledParty, displayCallingParty)"
          play-Sound="$ctrl.callPickup.playSound"
          display-calling-party="$ctrl.callPickup.displayCallingPartyId"
          display-called-party="$ctrl.callPickup.displayCalledPartyId">
        </uc-call-pickup-notifications>
      </div>
    </div>
  </div>
  <div class="cs-form__section">
    <div class="section__info">
      <h4 class="section__title" translate="callPickup.memberTitle"></h4>
    </div>
    <div class="section__content">
      <div class="sub-section">
        <h5 class="sub-section__title" translate="callPickup.memberLabel"></h5>
        <p class="sub-section__description" translate="callPickup.memberHint"></p>
        <uc-call-pickup-members
          on-update="$ctrl.onUpdateMember(member, isValidMember)"
          selected-members="$ctrl.selectedMembers"
          saved-call-pickup="$ctrl.callPickup"
          on-edit-update="$ctrl.onEditUpdateMember(savedCallPickup)">
        </uc-call-pickup-members>
      </div>
    </div>
  </div>
</form>
<div class="save-section call-pickup-save" ng-class="{invisible: !$ctrl.form.$dirty}">
  <p translate="common.saveLabel"></p>
  <button
    cs-btn
    ng-click="$ctrl.onCancel()">
    <span translate="common.cancel"></span>
  </button>
  <button
    cs-btn
    class="btn btn--primary"
    loading="$ctrl.saveInProcess"
    ng-click="$ctrl.updateCallPickup()"
    ng-disabled="$ctrl.form.$invalid || $ctrl.saveInProcess">
    <span translate="common.save"></span>
  </button>
</div>
