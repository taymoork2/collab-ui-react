<cs-page-header
  title-name="{{$ctrl.title}}"
  back="true"
  back-url="$ctrl.huronFeaturesUrl">
</cs-page-header>
<div class="call-feature-edit">
  <div class="loading-container" ng-if="$ctrl.isLoading">
    <i class='icon icon-spinner'></i>
  </div>
  <form novalidate class="cs-form content-container" name="$ctrl.form" role="form" ng-if="!$ctrl.isLoading">
    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="huronHuntGroup.settingsTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.nameLabel"></h5>
          <p class="sub-section__description" translate="huronHuntGroup.nameDesc"></p>
          <uc-call-feature-name
            placeholder-key="huronHuntGroup.namePlaceholder"
            name-hint-key="huronHuntGroup.nameHint"
            name="$ctrl.huntGroup.name"
            is-required="true"
            is-new="false"
            on-change-fn="$ctrl.setHuntGroupName(name)">
          </uc-call-feature-name>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.numbersLabel"></h5>
          <p class="sub-section__description"></p>
          <uc-hunt-group-numbers
            numbers="$ctrl.huntGroup.numbers"
            is-new="false"
            on-change-fn="$ctrl.setHuntGroupNumbers(numbers)">
          </uc-hunt-group-numbers>
        </div>
      </div>
    </div>

    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="huronHuntGroup.callSettingsTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.ringTimeLabel"></h5>
          <p class="sub-section__description" translate="huronHuntGroup.ringTimeDesc"></p>
          <uc-hunt-group-max-ring-time
            max-ring-secs="$ctrl.huntGroup.maxRingSecs"
            on-change-fn="$ctrl.setMaxRingSecs(seconds)">
          </uc-hunt-group-max-ring-time>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.waitTimeLabel"></h5>
          <p class="sub-section__description" translate="huronHuntGroup.waitTimeDesc"></p>
          <uc-hunt-group-max-wait-time
            max-wait-mins="$ctrl.huntGroup.maxWaitMins"
            on-change-fn="$ctrl.setMaxWaitMins(minutes)">
          </uc-hunt-group-max-wait-time>
        </div>
      </div>
    </div>

    <div class="cs-form__section" >
      <div class="section__info">
        <h4 class="section__title" translate="huronHuntGroup.fallbackLabel"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.fallbackRule"></h5>
          <div>
            <uc-hunt-group-fallback-destination
              destination-rule="$ctrl.huntGroup.destinationRule"
              fallback-destination="$ctrl.huntGroup.fallbackDestination"
              alternate-destination="$ctrl.huntGroup.alternateDestination"
              numbers="$ctrl.huntGroup.numbers"
              method="$ctrl.huntGroup.huntMethod"
              on-change-destination-rule-fn="$ctrl.setHuntGroupDestinationRule(destinationRule)"
              on-change-destination-fn="$ctrl.setHuntGroupFallbackDestination(fallbackDestination)"
              on-change-alternate-fn="$ctrl.setHuntGroupAlternateDestination(alternateDestination)">
            </uc-hunt-group-fallback-destination>
          </div>
        </div>
      </div>
    </div>

    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="huronHuntGroup.callsToSparkAppTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.callsToSparkAppLabel"></h5>
          <div>
            <uc-hunt-group-calls-to-spark-app
              send-to-app="$ctrl.huntGroup.sendToApp"
              on-change-fn="$ctrl.setHuntGroupSendToApp()"
              destination-rule="$ctrl.huntGroup.destinationRule">
            </uc-hunt-group-calls-to-spark-app>
          </div>
        </div>
      </div>
    </div>

    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="huronHuntGroup.huntingMethodMembersTitle"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.methodLabel"></h5>
          <p class="sub-section__description" translate="huronHuntGroup.methodDesc"></p>
          <div>
            <uc-hunt-group-method
              is-new="false"
              hunt-method="$ctrl.huntGroup.huntMethod"
              on-change-fn="$ctrl.setHuntGroupMethod(method)">
            </uc-hunt-group-method>
          </div>
        </div>
        <div class="sub-section">
          <h5 class="sub-section__title" translate="huronHuntGroup.membersLabel"></h5>
          <p class="sub-section__description" translate="huronHuntGroup.membersDesc"></p>
          <uc-call-feature-members
            members="$ctrl.huntGroup.members"
            member-item-type="number"
            remove-key="common.remove"
            show-numbers="true"
            show-external-numbers="true"
            filter-by="$ctrl.memberProperties"
            drag-and-drop="$ctrl.dragAndDropEnabled"
            on-change-fn="$ctrl.setHuntGroupMembers(members)">
          </uc-call-feature-members>
        </div>
      </div>
    </div>

    <div class="save-section" ng-class="{invisible: !$ctrl.form.$dirty}">
      <p translate="common.saveLabel"></p>
      <button
        cs-btn
        ng-click="$ctrl.onCancel()">
        <span translate="common.cancel"></span>
      </button>
      <button
        cs-btn
        class="btn btn--primary"
        loading="$ctrl.saveInProcess"
        ng-click="$ctrl.save()"
        ng-disabled="$ctrl.form.$invalid || $ctrl.saveInProcess">
        <span translate="common.save"></span>
      </button>
    </div>
  </form>
</div>
