<div class="huron-settings">
  <div class="loading-container" ng-if="$ctrl.loading">
    <i class="icon icon-spinner"></i>
  </div>

  <form novalidate name="$ctrl.form" ng-if="!$ctrl.loading" class="huron-settings-main-container">
    <div class="save-section" ng-class="{invisible: !$ctrl.form.$dirty}">
      <p></p>
      <button ng-click="$ctrl.onCancel()" translate="common.cancel"></button>
      <button class="btn btn--primary" cs-btn loading="$ctrl.processing" ng-click="$ctrl.showSaveDialogs()" ng-disabled="$ctrl.form.$invalid"><span translate="common.save"></span></button>
    </div>

    <!-- Media on Hold settings -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="serviceSetupModal.mohTitle"></h4>
        <h6 class="section__description" translate="serviceSetupModal.mohDesc"></h6>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <uc-company-media-on-hold
            company-moh="$ctrl.callSettingsData.companyMoh"
            company-moh-options="$ctrl.settingsOptions.companyMohOptions"
            on-change-fn="$ctrl.onCompanyMohChanged(companyMoh)">
          </uc-company-media-on-hold>
        </div>
      </div>
    </div>

    <!-- internal dialing section -->
    <div class="cs-form__section" ng-if="$ctrl.showRegionAndVoicemail">
      <div class="section__info">
        <h4 class="section__title" translate="serviceSetupModal.internalDialing"></h4>
      </div>
      <div class="section__content">
        <div class="sub-section">
          <uc-routing-prefix-length
            settings-data="$ctrl.callSettingsData"
            routing-prefix-length-saved-fn="$ctrl.onRoutingPrefixLengthSaved()">
          </uc-routing-prefix-length>
        </div>
        <div class="sub-section">
          <uc-extension-length
            first-time-setup="$ctrl.ftsw"
            extension-length="$ctrl.callSettingsData.customerVoice.extensionLength"
            settings-data="$ctrl.callSettingsData"
            extension-decrease-allowed="$ctrl.settingsOptions.extensionDecreaseAllowed"
            extension-length-saved-fn="$ctrl.onExtensionLengthSaved()"
            decrease-extension-length-fn="$ctrl.onDecreaseExtensionLength(extensionLength)"
            on-change-fn="$ctrl.onExtensionLengthChanged(extensionLength)">
          </uc-extension-length>
        </div>
      </div>
    </div>

    <!-- company voicemail selection -->
    <div class="cs-form__section" ng-if="$ctrl.showRegionAndVoicemail">
      <div class="section__info">
        <h4 class="section__title" translate="serviceSetupModal.voicemail"></h4>
      </div>
      <div class="section__content">
        <uc-location-company-voicemail  ng-if="!$ctrl.avrilI1559"
          ftsw="false"
          voicemail-pilot-number="$ctrl.callSettingsData.defaultLocation.voicemailPilotNumber"
          features="$ctrl.callSettingsData.avrilCustomer.features"
          dial-plan-country-code="$ctrl.settingsOptions.dialPlan.countryCode"
          external-number-options="$ctrl.settingsOptions.companyVoicemailOptions"
          company-voicemail-enabled="$ctrl.callSettingsData.customer.hasVoicemailService"
          on-change-fn="$ctrl.onCompanyVoicemailChanged(companyVoicemailEnabled, voicemailPilotNumber, features)"
          on-number-filter="$ctrl.onCompanyVoicemailFilter(filter)">
        </uc-location-company-voicemail>
        <div>
          <uc-voicemail  ng-if="$ctrl.avrilI1559"
            features="$ctrl.callSettingsData.avrilCustomer.features"
            voicemail-pilot-number="$ctrl.callSettingsData.defaultLocation.voicemailPilotNumber"
            dial-plan-country-code="$ctrl.settingsOptions.dialPlan.countryCode"
            external-number-options="$ctrl.settingsOptions.companyVoicemailOptions"
            company-voicemail-enabled="$ctrl.callSettingsData.customer.hasVoicemailService"
            preferred-language="$ctrl.callSettingsData.defaultLocation.preferredLanguage"
            on-change-fn="$ctrl.onCompanyVoicemailChanged(companyVoicemailEnabled, voicemailPilotNumber, features)"
            on-number-filter="$ctrl.onCompanyVoicemailFilter(filter)">
          </uc-voicemail>
        </div>
      </div>
    </div>

    <!-- company caller id selection -->
    <div class="cs-form__section">
      <div class="section__info">
        <h4 class="section__title" translate="companyCallerId.companyCallerId"></h4>
        <h6 class="section__description" translate="companyCallerId.companyCallerIdLocationDesc"></h6>
      </div>
      <div class="section__content">
        <uc-company-caller-id
          voicemail-pilot-number="$ctrl.callSettingsData.defaultLocation.voicemailPilotNumber.number"
          company-caller-id="$ctrl.callSettingsData.companyCallerId"
          external-number-options="$ctrl.settingsOptions.companyCallerIdOptions"
          customer-name="$ctrl.callSettingsData.customer.name"
          on-number-filter="$ctrl.onCompanyCallerIdFilter(filter)"
          on-change-fn="$ctrl.onCompanyCallerIdChanged(companyCallerId)">
        </uc-company-caller-id>
        </div>
      </div>

  </form>
</div>
