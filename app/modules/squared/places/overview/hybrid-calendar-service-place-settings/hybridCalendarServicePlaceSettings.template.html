<cs-sp-buttons ng-if="showButtons">
  <button id="btn-save" class="btn--primary btn-save" cs-btn loading="saving" ng-click="save()"><span
    translate="common.save"></span></button>
  <button id="btn-cancel" ng-disabled="saving" translate="common.cancel" ng-click="reset()"></button>
</cs-sp-buttons>
<cs-sp-container cs-tabindex="showButtons ? -1 : 0">
  <cs-sp-section class="cloud-extensions">
    <div class="section-title-row">
      <span class="section-name">{{'hercules.cloudExtensions.serviceNames.' + extension.id | translate}}</span>
      <cs-toggle-switch toggle-id="entitledToggle" ng-model="extension.entitled" size="small" ng-if="isUser"></cs-toggle-switch>
    </div>
    <div>
      <p class="extension-description" ng-if="isUser">{{'hercules.cloudExtensions.serviceDescriptions.' + extension.id | translate}}</p>
      <p class="extension-description" ng-if="isPlace">{{'hercules.cloudExtensions.serviceDescriptions.' + extension.id + '-place'| translate}}</p>

      <div>
        <span class="cloud-extension-label">{{'hercules.cloudExtensions.calendarType' | translate}}:</span>
        <input
          cs-input
          type="radio"
          ng-model="calendarType.selected"
          name="selectedType"
          value="squared-fusion-cal"
          id="selectedType_exchange"
          ng-disabled="!calendarType.exchangeEnabled"
          ng-change="selectedCalendarTypeChanged('squared-fusion-cal')"
          cs-input-label="{{calendarType.exchangeName}}"
          cs-input-help-text="{{calendarType.exchangeSetup ? '' : calendarType.notSetupText}}">
        <input
          cs-input
          type="radio"
          ng-model="calendarType.selected"
          name="selectedType"
          value="squared-fusion-gcal"
          id="selectedType_google"
          ng-disabled="!calendarType.googleEnabled"
          ng-change="selectedCalendarTypeChanged('squared-fusion-gcal')"
          cs-input-label="{{calendarType.googleName}}"
          cs-input-help-text="{{calendarType.googleSetup ? '' : calendarType.notSetupText}}">
      </div>

      <div ng-if="!isInvitePending" class="row collapse">
        <div class="columns small-3">
          <span class="cloud-extension-label">{{::'cloudExtensions.status' | translate}}:</span>
        </div>
        <div class="columns small-7 normal-line-height">
          <span class="cloud-extension-label" ng-if="extension.currentUserEntitled && extension.status && !savingEntitlements"
                ng-class="'status-' + extension.status.state"
                translate="hercules.activationStatus.{{getStatus(extension.status)}}"></span>
          <span class="cloud-extension-label last-state-change-timestamp" ng-if="extension.currentUserEntitled && extension.status && extension.status.lastStateChangeText && !savingEntitlements">{{extension.status.lastStateChangeText}}</span>
          <span class="cloud-extension-label status-off" ng-if="!extension.currentUserEntitled && !savingEntitlements" translate="common.off"></span>
          <span cs-loader ng-if="savingEntitlements || (!extension.status && extension.currentUserEntitled)"></span>
        </div>
        <div class="columns small-2">
          <span ng-if="extension.currentUserEntitled && extension.status && !savingEntitlements" class="cloud-extension-label right">
            <a ui-sref="{{currentStateName}}.history" translate="hercules.userHistory.seeHistory"></a>
          </span>
        </div>
      </div>

      <div ng-if="!isInvitePending" class="row collapse">
        <div class="columns small-9 small-offset-3">
          <user-status-messages ng-if="extension.currentUserEntitled && extension.status" messages="extension.status.messages"></user-status-messages>
        </div>
      </div>

      <hybrid-services-user-homed-cluster-and-hostname ng-if="extension.currentUserEntitled && extension.status.connectorId"
                                                       connector-id="extension.status.connectorId"></hybrid-services-user-homed-cluster-and-hostname>

      <div class="cloud-extension-label" ng-show="extension.currentUserEntitled && extension.id === 'squared-fusion-cal' && extension.hasShowPreferredWebExSiteNameFeatureToggle">
        <span class="cloud-extension-label">{{'hercules.cloudExtensions.preferredWebExSite' | translate}}:</span>
        <span class="cloud-extension-label">{{extension.preferredWebExSiteName}}</span>
      </div>

      <div
        ng-if="isInvitePending && extension.entitled"
        class="warning-message">
        <i class="icon icon-warning"></i>
        <p class="message">
          {{localizedOnboardingWarning}}
        </p>
      </div>

    </div>
  </cs-sp-section>

  <cs-sp-section class="cloud-extensions" ng-if="isPlace">
    <div class="row collapse cloud-extension-label normal-line-height mailid">
      <div class="columns small-12"><span translate="addDeviceWizard.editServices.calendarEmail"></span><span>: {{emailOfMailbox}}</span></div>
    </div>
    <div class="row collapse cloud-extension-label normal-line-height">{{'hercules.placeSidepanel.email-calendar-explanation-part1' | translate}}
      <a ng-click="editCloudberryServices(extension.id)">{{'hercules.placeSidepanel.email-calendar-explanation-part2' | translate}}</a>
    </div>
  </cs-sp-section>

  <cs-sp-section class="cloud-extensions" ng-if="resourceGroup.show">
    <div class="section-title-row">
      <span class="section-name" translate="hercules.resourceGroups.resourceGroupHeading"></span>
    </div>
    <div ng-if="!resourceGroup.cannotFindResouceGroup">
      <p class="extension-description" translate="hercules.resourceGroups.setDescription"></p>
      <cs-select
        ng-model="resourceGroup.selected"
        options="resourceGroup.options"
        on-change-fn="selectedResourceGroupChanged()">
      </cs-select>
      <div class="warning-message" ng-if="resourceGroup.shouldWarn">
        <i class="icon icon-warning"></i>
      <p class="message"
         translate="hercules.resourceGroups.groupIsEmptyWarning"
         translate-values="{ConnectorName: localizedConnectorName}">
      </p>
      </div>
    </div>
    <div ng-if="resourceGroup.cannotFindResouceGroup" class="error-message">
      <i class="icon icon-error"></i>
      <p class="message"
         translate="hercules.resourceGroups.groupHasBeenDeleted"></p>
      <form>
        <button class="btn" type="submit" ng-click="setResourceGroupOnUser('')">
          <span translate="common.remove"></span>
        </button>
      </form>
    </div>
  </cs-sp-section>
</cs-sp-container>

